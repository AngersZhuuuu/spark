-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW t1 AS SELECT * FROM VALUES 0, 1, 2 AS t(id)
-- !query schema
struct<>
-- !query output



-- !query
CACHE TABLE cache_table
WITH
t2 AS (SELECT 1)
SELECT * FROM t2
-- !query schema
struct<>
-- !query output



-- !query
SELECT * FROM cache_table
-- !query schema
struct<1:int>
-- !query output
1


-- !query
EXPLAIN EXTENDED SELECT * FROM cache_table
-- !query schema
struct<plan:string>
-- !query output
== Parsed Logical Plan ==
'Project [*]
+- 'UnresolvedRelation [cache_table], [], false

== Analyzed Logical Plan ==
1: int
Project [1#x]
+- SubqueryAlias cache_table
   +- View (`cache_table`, [1#x])
      +- Project [cast(1#x as int) AS 1#x]
         +- WithCTE
            :- CTERelationDef xxxx, false
            :  +- SubqueryAlias t2
            :     +- Project [1 AS 1#x]
            :        +- OneRowRelation
            +- Project [1#x]
               +- SubqueryAlias t2
                  +- CTERelationRef xxxx, true, [1#x], false

== Optimized Logical Plan ==
InMemoryRelation [1#x], StorageLevel(disk, memory, deserialized, 1 replicas)
   +- *Project [1 AS 1#x]
      +- *Scan OneRowRelation[]

== Physical Plan ==
AdaptiveSparkPlan isFinalPlan=false
+- Scan In-memory table cache_table [1#x]
      +- InMemoryRelation [1#x], StorageLevel(disk, memory, deserialized, 1 replicas)
            +- *Project [1 AS 1#x]
               +- *Scan OneRowRelation[]


-- !query
DROP TABLE IF EXISTS t1
-- !query schema
struct<>
-- !query output

