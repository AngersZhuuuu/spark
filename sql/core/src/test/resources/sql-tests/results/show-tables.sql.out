-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 27


-- !query
CREATE DATABASE showdb
-- !query schema
struct<>
-- !query output



-- !query
USE showdb
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE show_t1(a String, b Int, c String, d String) USING parquet PARTITIONED BY (c, d)
-- !query schema
struct<>
-- !query output



-- !query
ALTER TABLE show_t1 ADD PARTITION (c='Us', d=1)
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE show_t2(b String, d Int) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE TEMPORARY VIEW show_t3(e int) USING parquet
-- !query schema
struct<>
-- !query output



-- !query
CREATE GLOBAL TEMP VIEW show_t4 AS SELECT 1 as col1
-- !query schema
struct<>
-- !query output



-- !query
SHOW TABLES
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
show_t1
show_t2
show_t3


-- !query
SHOW TABLES IN showdb
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
show_t1
show_t2
show_t3


-- !query
SHOW TABLES 'show_t*'
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
show_t1
show_t2
show_t3


-- !query
SHOW TABLES LIKE 'show_t1*|show_t2*'
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
show_t1
show_t2


-- !query
SHOW TABLES IN showdb 'show_t*'
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
show_t1
show_t2
show_t3


-- !query
SHOW TABLES IN showdb LIKE 'show_t*'
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean>
-- !query output
show_t1
show_t2
show_t3


-- !query
SHOW TABLE EXTENDED LIKE 'show_t*'
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean,information:struct<Database:string,Table:string,Owner:string,Created Time:date,Last Access:date,Created By:string,Type:string,Provider:string,Bucket:struct<Num Buckets:string,Bucket Columns:string,Sort Columns:string>,Comment:string,View Information:struct<View Text:string,View Original Text:string,View Catalog and Namespace:string,View Query Output Columns:string>,Table Properties:string,Statistics:string,Storage:struct<Location:string,Serde Library:string,InputFormat:string,OutputFormat:string,Compressed:string,Storage Properties:string>,Partition Provider:string,Partition Columns:string,Partition Values:string,Partition Parameters:string,Partition Statistics:string,schema:string>>
-- !query output
Database:"showdb"
Table:"show_t1"
Owner:"UNKNOWN"
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type:"MANAGED"
Provider:"parquet"
Bucket:null
Comment:null
View Information:null
Table Properties:"[]"
Statistics:null
Storage:{"Location [not included in comparison]/{warehouse_dir}/showdb.db/show_t1","Serde Library":null,"InputFormat":null,"OutputFormat":null,"Compressed":"false","Storage Properties":null}
Partition Provider:"Catalog"
Partition Columns:"[`c`, `d`]"
Partition Values:null
Partition Parameters:null
Partition Statistics:null
schema:"struct<a:string,b:int,c:string,d:string>"

Database:"showdb"
Table:"show_t2"
Owner:"UNKNOWN"
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type:"MANAGED"
Provider:"parquet"
Bucket:null
Comment:null
View Information:null
Table Properties:"[]"
Statistics:null
Storage:{"Location [not included in comparison]/{warehouse_dir}/showdb.db/show_t2","Serde Library":null,"InputFormat":null,"OutputFormat":null,"Compressed":"false","Storage Properties":null}
Partition Provider:null
Partition Columns:null
Partition Values:null
Partition Parameters:null
Partition Statistics:null
schema:"struct<b:string,d:int>"

Database:null
Table:"show_t3"
Owner:"UNKNOWN"
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type:"VIEW"
Provider:null
Bucket:null
Comment:null
View Information:{"View Text":null,"View Original Text":null,"View Catalog and Namespace":null,"View Query Output Columns":null}
Table Properties:"[]"
Statistics:null
Storage:{"Location":null,"Serde Library":null,"InputFormat":null,"OutputFormat":null,"Compressed":"false","Storage Properties":null}
Partition Provider:null
Partition Columns:null
Partition Values:null
Partition Parameters:null
Partition Statistics:null
schema:"struct<e:int>"


-- !query
SHOW TABLE EXTENDED
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException

mismatched input '<EOF>' expecting {'FROM', 'IN', 'LIKE'}(line 1, pos 19)

== SQL ==
SHOW TABLE EXTENDED
-------------------^^^


-- !query
SHOW TABLE EXTENDED LIKE 'show_t1' PARTITION(c='Us', d=1)
-- !query schema
struct<namespace:string,tableName:string,isTemporary:boolean,information:struct<Database:string,Table:string,Owner:string,Created Time:date,Last Access:date,Created By:string,Type:string,Provider:string,Bucket:struct<Num Buckets:string,Bucket Columns:string,Sort Columns:string>,Comment:string,View Information:struct<View Text:string,View Original Text:string,View Catalog and Namespace:string,View Query Output Columns:string>,Table Properties:string,Statistics:string,Storage:struct<Location:string,Serde Library:string,InputFormat:string,OutputFormat:string,Compressed:string,Storage Properties:string>,Partition Provider:string,Partition Columns:string,Partition Values:string,Partition Parameters:string,Partition Statistics:string,schema:string>>
-- !query output
Database:null
Table:null
Owner:null
Created Time [not included in comparison]
Last Access [not included in comparison]
Created By [not included in comparison]
Type:null
Provider:null
Bucket:null
Comment:null
View Information:null
Table Properties:null
Statistics:null
Storage:{"Location [not included in comparison]/{warehouse_dir}/showdb.db/show_t1/c=Us/d=1","Serde Library":null,"InputFormat":null,"OutputFormat":null,"Compressed":"false","Storage Properties":null}
Partition Provider:null
Partition Columns:null
Partition Values:"[c=Us, d=1]"
Partition Parameters:null
Partition Statistics:null
schema:null


-- !query
SHOW TABLE EXTENDED PARTITION(c='Us', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException

mismatched input 'PARTITION' expecting {'FROM', 'IN', 'LIKE'}(line 1, pos 20)

== SQL ==
SHOW TABLE EXTENDED PARTITION(c='Us', d=1)
--------------------^^^


-- !query
SHOW TABLE EXTENDED LIKE 'show_t*' PARTITION(c='Us', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchTableException
Table or view 'show_t*' not found in database 'showdb'


-- !query
SHOW TABLE EXTENDED LIKE 'show_t1' PARTITION(c='Us')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Partition spec is invalid. The spec (c) must match the partition spec (c, d) defined in table '`showdb`.`show_t1`'


-- !query
SHOW TABLE EXTENDED LIKE 'show_t1' PARTITION(a='Us', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
a is not a valid partition column in table `showdb`.`show_t1`.


-- !query
SHOW TABLE EXTENDED LIKE 'show_t1' PARTITION(c='Ch', d=1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.analysis.NoSuchPartitionException
Partition not found in table 'show_t1' database 'showdb':
c -> Ch
d -> 1


-- !query
DROP TABLE show_t1
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE show_t2
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW  show_t3
-- !query schema
struct<>
-- !query output



-- !query
DROP VIEW  global_temp.show_t4
-- !query schema
struct<>
-- !query output



-- !query
USE default
-- !query schema
struct<>
-- !query output



-- !query
DROP DATABASE showdb
-- !query schema
struct<>
-- !query output

