-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 10


-- !query
CREATE OR REPLACE TEMPORARY VIEW t1 AS SELECT * FROM VALUES
('1', true, unhex('537061726B2053514C'), tinyint(1), smallint(100), array_position(array(3, 2, 1), 1), float(1.0), 1.0, Decimal(1.0), timestamp('1997-01-02'), date('2000-04-01')),
('2', false, unhex('537061726B2053514C'), tinyint(2), smallint(200), array_position(array(3, 2, 1), 2), float(2.0), 2.0, Decimal(2.0), timestamp('1997-01-02 03:04:05'), date('2000-04-02')),
('3', true, unhex('537061726B2053514C'), tinyint(3), smallint(300), array_position(array(3, 2, 1), 1), float(3.0), 3.0, Decimal(3.0), timestamp('1997-02-10 17:32:01-08'), date('2000-04-03'))
as t1(a, b, c, d, e, f, g, h, i, j, k)
-- !query schema
struct<>
-- !query output



-- !query
SELECT TRANSFORM(a)
USING 'cat' AS (a)
FROM t1
-- !query schema
struct<a:string>
-- !query output
1
2
3


-- !query
SELECT TRANSFORM(a)
USING 'some_non_existent_command' AS (a)
FROM t1
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
Subprocess exited with status 127. Error: /bin/bash: some_non_existent_command: command not found


-- !query
SELECT TRANSFORM(a)
USING 'python some_non_existent_file' AS (a)
FROM t1
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
Subprocess exited with status 2. Error: python: can't open file 'some_non_existent_file': [Errno 2] No such file or directory


-- !query
SELECT a, b, decode(c, 'UTF-8'), d, e, f, g, h, i, j, k FROM (
    SELECT TRANSFORM(a, b, c, d, e, f, g, h, i, j, k)
    USING 'cat' AS (
        a string,
        b boolean,
        c binary,
        d tinyint,
        e smallint,
        f long,
        g float,
        h double,
        i decimal(38, 18),
        j timestamp,
        k date)
    FROM t1
) tmp
-- !query schema
struct<a:string,b:boolean,decode(c, UTF-8):string,d:tinyint,e:smallint,f:bigint,g:float,h:double,i:decimal(38,18),j:timestamp,k:date>
-- !query output
1	true	Spark SQL	1	100	3	1.0	1.0	1.000000000000000000	1997-01-02 00:00:00	2000-04-01
2	false	Spark SQL	2	200	2	2.0	2.0	2.000000000000000000	1997-01-02 03:04:05	2000-04-02
3	true	Spark SQL	3	300	3	3.0	3.0	3.000000000000000000	1997-02-10 17:32:01	2000-04-03


-- !query
SELECT TRANSFORM(a, b)
USING 'cat'
FROM t1
-- !query schema
struct<key:string,value:string>
-- !query output
1	true
2	false
3	true


-- !query
SELECT TRANSFORM(a, b, c)
USING 'cat' as (a int, b int , c int)
FROM (
    SELECT
    1 AS a,
    "a" AS b,
    CAST(2000 AS timestamp) AS c
) tmp
-- !query schema
struct<a:int,b:int,c:int>
-- !query output
1	NULL	NULL


-- !query
SELECT TRANSFORM(b, max(a), sum(f))
USING 'cat' AS (a, b)
FROM t1
GROUP BY b
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.catalyst.parser.ParseException

mismatched input 'GROUP' expecting {<EOF>, ';'}(line 4, pos 0)

== SQL ==
SELECT TRANSFORM(b, max(a), sum(f))
USING 'cat' AS (a, b)
FROM t1
GROUP BY b
^^^


-- !query
MAP a, b USING 'cat' AS (a, b) FROM t1
-- !query schema
struct<a:string,b:string>
-- !query output
1	true
2	false
3	true


-- !query
REDUCE a, b USING 'cat' AS (a, b) FROM t1
-- !query schema
struct<a:string,b:string>
-- !query output
1	true
2	false
3	true
