-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 8


-- !query
CREATE OR REPLACE TEMPORARY VIEW t1 AS SELECT * FROM VALUES
('a'), ('b'), ('v')
as t1(a)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW t2 AS SELECT * FROM VALUES
('1', true, unhex('537061726B2053514C'), tinyint(1), array_position(array(3, 2, 1), 1), float(1.0), 1.0, Decimal(1.0), timestamp(1), current_date),
('2', false, unhex('537061726B2053514C'), tinyint(2),  array_position(array(3, 2, 1), 2), float(2.0), 2.0, Decimal(2.0), timestamp(2), current_date),
('3', true, unhex('537061726B2053514C'), tinyint(3),  array_position(array(3, 2, 1), 1), float(3.0), 3.0, Decimal(3.0), timestamp(3), current_date)
as t2(a,b,c,d,e,f,g,h,i,j)
-- !query schema
struct<>
-- !query output



-- !query
SELECT TRANSFORM(a)
USING 'cat' AS (a)
FROM t1
-- !query schema
struct<a:string>
-- !query output
a
b
v


-- !query
SELECT TRANSFORM(a)
USING 'some_non_existent_command' AS (a)
FROM t1
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
Subprocess exited with status 127. Error: /bin/bash: some_non_existent_command: command not found


-- !query
SELECT TRANSFORM(a)
USING 'python some_non_existent_file' AS (a)
FROM t1
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
Subprocess exited with status 2. Error: python: can't open file 'some_non_existent_file': [Errno 2] No such file or directory


-- !query
SELECT a, b, decode(c, 'UTF-8'), d, e, f, g, h, i, j FROM (
    SELECT TRANSFORM(a, b, c, d, e, f, g, h, i, j)
    USING 'cat' AS (a string, b boolean, c binary, d tinyint, e long, f float, g double, h decimal(38, 18), i timestamp, j date)
    FROM t2
) tmp
-- !query schema
struct<a:string,b:boolean,decode(c, UTF-8):string,d:tinyint,e:bigint,f:float,g:double,h:decimal(38,18),i:timestamp,j:date>
-- !query output
1	true	Spark SQL	1	3	1.0	1.0	1.000000000000000000	1969-12-31 16:00:01	2020-07-18
2	false	Spark SQL	2	2	2.0	2.0	2.000000000000000000	1969-12-31 16:00:02	2020-07-18
3	true	Spark SQL	3	3	3.0	3.0	3.000000000000000000	1969-12-31 16:00:03	2020-07-18


-- !query
SELECT TRANSFORM(a, b)
USING 'cat'
FROM t2
-- !query schema
struct<key:string,value:string>
-- !query output
1	true
2	false
3	true


-- !query
SELECT TRANSFORM(a, b, c)
USING 'cat' as (a int, b int , c int)
FROM (
    SELECT
    1 AS a,
    "a" AS b,
    CAST(2000 AS timestamp) AS c
) tmp
-- !query schema
struct<a:int,b:int,c:int>
-- !query output
1	NULL	NULL
