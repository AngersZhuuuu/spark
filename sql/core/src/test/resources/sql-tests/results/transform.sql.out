-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 8


-- !query
CREATE OR REPLACE TEMPORARY VIEW t1 AS SELECT * FROM VALUES
('a'), ('b'), ('v')
as t1(a)
-- !query schema
struct<>
-- !query output



-- !query
CREATE OR REPLACE TEMPORARY VIEW t2 AS SELECT * FROM VALUES
(1, '1', 1.0, Decimal(1.0), timestamp(1)),
(2, '2', 2.0, Decimal(2.0), timestamp(2)),
(2, '2', 3.0, Decimal(3.0), timestamp(3))
as t2(a,b,c,d,e)
-- !query schema
struct<>
-- !query output



-- !query
SELECT TRANSFORM(a)
USING 'cat' AS (a)
FROM t1
-- !query schema
struct<a:string>
-- !query output
a
b
v


-- !query
SELECT TRANSFORM(a)
USING 'some_non_existent_command' AS (a)
FROM t1
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
Subprocess exited with status 127. Error: /bin/bash: some_non_existent_command: command not found


-- !query
SELECT TRANSFORM(a)
USING 'python some_non_existent_file' AS (a)
FROM t1
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkException
Subprocess exited with status 2. Error: python: can't open file 'some_non_existent_file': [Errno 2] No such file or directory


-- !query
SELECT TRANSFORM(a, b, c, d, e)
USING 'CAT' AS (a, b, c, d, e)
FROM t2
-- !query schema
struct<a:string,b:string,c:string,d:string,e:string>
-- !query output
1	1	1.0	1	1969-12-31 16:00:01
2	2	2.0	2	1969-12-31 16:00:02
2	2	3.0	3	1969-12-31 16:00:03


-- !query
SELECT TRANSFORM(a, b)
USING 'CAT'
FROM t2
-- !query schema
struct<key:string,value:string>
-- !query output
1	1
2	2
2	2


-- !query
SELECT TRANSFORM(a, b, c)
USING 'cat' as (a int, b int , c int)
FROM (
SELECT
1 AS a,
"a" AS b,
CAST(2000 AS timestamp) AS c
) tmp
-- !query schema
struct<a:int,b:int,c:int>
-- !query output
1	NULL	NULL
